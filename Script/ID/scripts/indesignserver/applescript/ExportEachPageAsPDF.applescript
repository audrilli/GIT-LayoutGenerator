--ExportEachPageAsPDF.applescript--An InDesign Server AppleScript--Exports each page of an InDesign document as a separate PDF to--a specified folder using the current PDF export settings.tell application "InDesignServer"	if (count documents) is greater than 0 then		--Fill in a valid file path on your system.		tell application "Finder"			set myFolderName to (startup disk as string) & "ServerTestFiles"		end tell		my myExportPages(document 1, myFolderName)	else		set result to "No documents are open."	end ifend tellon myExportPages(myDocument, myFolderName)	tell application "InDesignServer"		set myBaseName to name of myDocument		repeat with myCounter from 1 to (count pages in myDocument)			set myPageName to name of page myCounter of myDocument			set page range of PDF export preferences to name of page myCounter of myDocument			--Generate a file path from the folder name, the base document name, and the page name.			--Replace any colons in the page name (e.g., "Sec1:1") so that they don't cause			--problems with file naming.			set myPageName to my myReplace(myPageName, ":", "_")			set myFilePath to myFolderName & myBaseName & "_" & myPageName & ".pdf"			tell myDocument				--The export command will fail if you provide the file path				--as Unicode text--that's why we had to convert the folder name				--to plain text.				export format PDF type to myFilePath			end tell		end repeat	end tellend myExportPageson myReplace(myString, myFindString, myChangeString)	set AppleScript's text item delimiters to myFindString	set myTextList to every text item of (myString as string)	set AppleScript's text item delimiters to myChangeString	set myString to myTextList as string	set AppleScript's text item delimiters to ""	return myStringend myReplace